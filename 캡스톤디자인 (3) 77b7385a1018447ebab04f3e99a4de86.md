# 캡스톤디자인 (3)

2023년 2월 5일 

# Contents

---

# 계획

<aside>
💡 시연은 종강까지 한 달 정도 남은 상태부터 이루어져야 하므로, 적어도 5월 초까지는 준비가 끝나 있어야 한다.

</aside>

1. 2~3월 : 기획 단계 및 프로토타이핑
    1. 계획서 작성하기
        1. **기획 동기**
        2. **페르소나**
        3. **아이디어 제안**
        4. **화면 설계**
        5. **요구사항 명세서**
        6. 사용할 기술스택
        7. 개발 계획
        8. 해결해야 할 부분들
    2. 프로토타이핑
        1. 프로젝트는 프론트엔드, 백엔드 나누어 Repo 관리
        2. 아키텍처는 여러 방향으로 생각해 보고 답 찾기
        3. 간단히 시연하는 것이 목표이므로, 라즈베리파이 모니터에 연결하고 API 서버와 통신하면서 목표로 하는 기능이 잘 돌아가게 하기
2. 3~4월 중순 : 프로토타이핑 및 시연 준비, 중간 보고서 → 이후 중간고사 및 정처기 실기, 부트캠프 준비
    1. 계획서 및 프로토타입 기반으로 중간 보고서 작성하기
    2. 프로토타이핑 마무리되면 학과, 단과대, 학사팀에 시연하고 승인 받기
    3. 승인되면 시연 준비하고 실제 서비스하기
3. 5월 초~종강 : 실제 시연 및 고객 의견 수렴, 서비스 개선, 최종 보고서
    1. 이용객들에 설문조사 페이지 QR코드를 통해 의견 수렴하기
    2. 문제점 보완하기
    3. 최종 보고서 작성하기

# 역할 분담

- 프론트엔드: Android (최소 버전 12 (SDK 32))
    - 이거를 1~2명이 하거나 혼자 해도 됨
    - Jetpack Compose 기반으로 뷰 짜고, API 통신은 Retrofit2 쓴다.
    - 필요하면 사용자용 BLE 앱 만들어서 주변 장치와 연동하고, 배포해보기?
        - ~~오픈소스 기말플젝에서 재탕해보자~~
        - 블루투스 특유의 연결 문제 → 버스 알림 단말기에서 어떻게 연결을 허용할 것인지?
            - 무작정 아무거나 연결하면 성능 문제, 보안 문제가 생길 수 있음

- 백엔드: Spring 기반?
    - 실제 여건
        - 팀별 최소 인원수 5명 → 인원 충원 필요성
        - AWS에 3~4명이 달라붙기에는 너무 많고 불필요함
            - 백엔드 담당하는 사람들 포폴거리 만들어야 한다는 필요성 또한 대두되어, 스프링을 적용하는 것을 고려하고 있음
    - 기존 안건
        - AWS Lambda, API Gateway, DynamoDB 등 클라우드 기반
            - 백엔드가 사실은 제일 중요
            - 나머지

- 그 외 발표, 시연을 위한 세트 마련, 문서작성은 협의하기
    - 과제제안 발표, 최종발표 (영어로)
    - 세트 마련 - 아래 요소들을 하나로 담을 수 있는 틀 마련하기. 크게 전면, 후면, 측면으로 구분
        1. 전면 - 본체 (10~11인치 태블릿 2대. 가로 방향으로 이어붙일지 세로 방향으로 이어붙일지는 미정이지만 어쨋든 전면에 넣을 예정)
        2. 후면 - 상시전원 + 배터리팩 4대 혹은 배터리팩 6~8대 넣을 자리 + 고정틀
            - 상시전원이 없을 수도 있을 수도 있음. 학교에서 만약에 상시전원을 못 따주면 배터리로만 운용해야 함
            - 상시전원이 있다면, 전기선을 2~3구 콘센트에 연결하고 여기에 2포트 접지 충전기를 콘센트에 연결한다. 그리고 접지 충전기로부터 태블릿 2대를 모두 연결한다.
                - 후면에 콘센트를 고정할 수 있도록 틀을 마련하고, 밖으로 드러나지 않게 절연테이프 등으로 잘 가려준다.
        3. 측면 - 고정틀 및 잠금 장치
            - 벽면에 붙일 방법과 도난 방지, 훼손 방지를 위한 방안을 마련해야 함
        - 세트는 아크릴판 도면을 만들어서 관련 업체에 프린팅 맡기거나, 3D 프린팅 도면을 만들어서 학교 공학관이나 소웨관에 있는 3D 프린터로 만드는 방법으로 만들 수 있다.
            - 예산을 얼마로 잡아야 좋을까..? 공부하면서 만드는 데 걸리는 시간도 고려해야 한다.

- 저전력 세팅 관련
    - 상시전원이라면 거의 큰 문제는 없겠지만, 상시전원을 물리더라도 학교 전체가 정전되는 상황이 터질 수 있으며, 상시전원을 받지 못하는 상황이라면 24/7 내내 배터리로 운용해야 한다.
    - 배터리를 운용한다면, 용량과 무관하게 주기적으로 충전해 주어야 하는데, 충전 주기를 더 늘리는 방향으로 가는 것이 합리적일 것이다.
    - 충전 주기를 늘리는 데에는 크게 두 가지 방법이 있다.
        1. 배터리팩의 물리적인 용량을 늘린다
            
            → 비용 문제도 있고, 배터리 용량이 커질수록 넓이도 커지고 높이도 커진다는 문제가 있다.
            
        2. 태블릿 자체의 소모 전력을 줄인다
            
            → 가장 합리적인 방법이라고 할 수 있는데, 태블릿의 AP가 성능 위주의 빅코어와 전력 효율 위주의 리틀코어로 이원화된다는 것을 활용한 방법이다.
            
            - 우리가 굴릴 태블릿은 보통 스냅드래곤 6~700번대 또는 미디어텍 헬리오 P시리즈, G시리즈일 것이다. 이러한 AP들은 일반적으로 빅코어 2개 또는 4개와 리틀코어 4개의 조합으로 구성되어 있다.
            - 프로젝트에서 설계하고 구현할 클라이언트 사이드에서의 주 기능은 다음과 같다.
                1. 24/7 내내 가동상태 유지
                2. 첫차~막차 약 18시간 동안 5초에 한 번 꼴로 API 서버에 요청 보내기
                3. 응답 받은 데이터를 바탕으로 뷰 갱신
                4. 도착 시간이 임박하면 (ex) 치대병원 기준 24번 버스 정류장의 현재 위치가 “대지고등학교, 전내교차로” 인 경우), 태블릿에 내장된 스피커로 주변에 알리기
            - 기능들을 보면 알겠지만, 무거운 성능 위주의 작업보다는 지속적으로 특정 작업만을 반복하면서 수행하는 것을 알 수 있다. 따라서 태블릿의 전력 효율을 높이려면 최소한의 작업을 수행할 수 있는 정도 내에서만 코어를 유지하고 나머지 코어들은 모두 끄는 것이 좋은 선택이다.
                - ex) 4+4 코어 구성 → 빅코어 4개는 모두 끄고 리틀코어도 1~2개만 남기고 나머지는 모두 끈다
            - 코어를 끄려면 커널을 tweak해야 하는데, 이를 위해서는 구매하려는 태블릿이 개발 친화적이어야 한다. 다시 말해서, 태블릿이 다음과 같은 조건을 만족해야 한다.
                - 부트로더 언락을 지원하는지
                - 벽돌 복구를 지원하는지
                - 해당 기기의 커널 소스가 공개되어 있는지
                - 해당 기기의 커스텀 커널 개발이 활발한지
            
        3. 배터리 충전 제한을 걸어야 한다.
            - 대부분의 스마트 기기에 들어가는 배터리는 리튬 이온 배터리로, 오랜 시간동안 완충 상태를 유지하거나 완전 방전 상태가 된다면 배터리 상태가 더 빨리 악화될 수 있다. 이로 인해 기기의 수명이 크게 단축될 수 있다.
            - 우리 프로젝트에서는 시연 시 24/7 내내 전원을 물려놓아야 하는데, 이렇게 되면 과충전 이슈를 피해갈 수 없다.
            - 따라서, root 권한을 획득하여 펌웨어 내부적으로 배터리 충전 제한을 걸어두어 85%~90% 즈음 도달했을 때 충전이 되지 않게 한다면 이러한 과충전 문제를 피할 수 있다.
            - 안드로이드 기기에서 root 권한을 획득하기 위해서는 우선 부트로더 언락이 되어 있어야 한다. 안드로이드 기기 선택 조건 중 부트로더 언락 지원 여부가 포함되어 있는 이유에는 바로 이런 요인이 그 중 하나인 것이다.

# 예산 관련

<aside>
💡 **3월달에 링크사업단 주관 캡스톤디자인 지원사업, 경진대회 신청하여 지원금 꼭 타기.
70만원 준다. 꼭 하자. [바로가기](https://portal.dankook.ac.kr/p/CTT006?b=1&p=13295)**

</aside>

- 단국대정문, 단국대치과병원 정류장에 각각 1세트씩 둘 것
- 세트마다 마련해야 할 것들
    - 10~11인치 태블릿 2x2대 (약 20만원 내외 x 2 = 약 40만원대)
        - 기종 선택 조건
            - 부트로더 언락을 지원하는지
            - 벽돌 복구를 지원하는지
            - 해당 기기의 커널 소스가 공개되어 있는지
            - 해당 기기의 커스텀 커널 개발이 활발한지
    - 20,000mAh 보조배터리 4x2대 (약 2만원 내외 x 8 = 약 16만원대)
    - 그 외 여비 (아크릴판 프린팅 비용 or 상시전원 받는 경우 추가 세팅 비용 or 피드백 설문조사 경품 지급 비용 등) → 70만원 - 약 56만원 (최대 60만원 가량) = 약 10만원대
    - 옛날거
        - [라즈베리파이](https://www.devicemart.co.kr/goods/view?no=1311414) (대충 간단한 네이티브 앱 돌아가고, 안드로이드 13이 돌아가야 하는 사양)
            - [최소사양 관련 기사](https://arstechnica.com/gadgets/2022/09/android-13-raises-minimum-system-requirement-to-2gb-of-ram-16gb-of-storage/) → 램 2GB 이상, 스토리지 16GB 이상
            - [안드로이드 설치 강좌](https://makeutil.tistory.com/185)
            - 정격 전원은 5V 0.7A → 3.5W.. 그러면 5V 1A짜리 어댑터를 연결하면 되겠군
            - 외장 microSD 카드 (16기가 이상, class 10 이상)
        - 디스플레이 (큰 화면일수록 좋은데 전원 입력이 문제..)
            - 일반적인 모니터 vs 포터블 모니터 2대 연결?
                - 소모전력 및 직류전원 사용 여부 생각하면 후자가 낫긴 하다.
            - ******************************************시연 단계에서는 학교에서 굴러다니는 모니터 한 대로 간단히 해보자******************************************
        - 전원 공급 관련 (보조배터리냐 UPS냐.. 상전을 학교에서 끌어올 방법은 없을까?)
        - 방수 커버 및 안전장치 (비에 젖지 않아야 하고, 도난을 방지해야 함.)

# 다른 의견 (old)

- 본문
    
    지금 우리가 처한 문제는 다음과 같다.
    
    1. 라즈베리파이 전량 품절
    2. 본체 - 디스플레이 연결을 어떻게?
    
    - **1번 문제같은 경우, 우리는 안드로이드 실행환경에서 앱 설치 후 디스플레이와 연결하여 화면 미러링하는 것이 목적이므로 정식으로 시연하는 단계에서도 굳이 보드를 살 필요가 없다고 생각함.**
    - 지원금 받고 시연 승인나기 전까지는 공기계 또는 에뮬레이터로 개발하고 학교에 프로토타입 보여주는 정도까지는 할 수 있을 것 같음.
    - 그럼 실제 시연 시, 어떤 안드로이드 기기를 구하는 것이 좋을까?
    그래서 여러 조건들을 생각해 보았다.
        1. 안드로이드 12 이상 탑재 기기
            - 선탑재 버전은 사실 그렇게 중요하지는 않다. 다음 조건들만 만족하면 상관없기 때문이다.
        2. 부트로더 언락이 가능한 기기
            - 3번 과정에서의 커스텀 롬 설치를 통해, 안드로이드 버전이 낮은 기기더라도 최신 버전으로 업데이트할 수 있다.
            - 부트로더 언락을 하면 커널 이미지를 패치하는 방법으로 루트 권한을 획득할 수 있는데 (자세한건 Magisk 참조),
                - 이를 통해 배터리 충전 % 제한을 걸 수 있어, 최대로 충전되는 %를 제한함으로써 과충전을 방지할 수 있다.
                - 과충전 상태를 장기간 유지하면 배터리 성능이 낮아질 수 있음은 물론, 심하면 배터리가 부풀거나 화재가 발생할 수 있다.
                - 기기를 오랜 기간동안 전시하며 전원을 계속하여 공급해야 하는 것이 이번 과제에서 주어진 요구사항 중 하나다.
        3. 1번 조건에 해당하지 않는다면, 해당 기기에서 설치할 수 있는 커스텀 롬이 나와 있는지, 
        아니면 하다못해 GSI 롬으로 설치할 수 있는지? (Treble을 지원하는 기기인지?)
            - 이 방법을 통해서 만일 안드로이드 7에서 지원 중단된 기기더라도, 이를 통해 최신 버전인 안드로이드 13까지도 설치할 수 있다는 것이다.
        4. 제일 중요한 조건으로, 해당 기기가 DP Alt Mode를 지원하여 기기의 USB-C 포트와 디스플레이의 HDMI 또는 DP 포트 사이를 케이블로 연결해서 디스플레이 출력이 가능한지?
            - 일반적으로 디스플레이 출력 자체가 큰 대역폭을 요구하므로, 기기는 USB-C 포트뿐 아니라 USB 3.1 이상의 인터페이스를 탑재하고 있어야 한다.

# 또 다른 의견 (old)

<aside>
💡 스마트폰이나 라즈베리파이와 같은 개발용 보드 말고, 아예 안드로이드 기반 태블릿을 사서 전시하면,
디스플레이와 개발용 기기 따로 구매하지 않아도 되고, 전원 공급 문제도 간단하게 해결할 수 있지 않을까?

</aside>

- 그러면 구매할 수 있는 기기의 기준을 생각해 보자.
안드로이드 환경에서 앱 구동하고 사람들에게 보여주는 것이 목표이므로, 요구사항은 거의 동일하다.
    1. 안드로이드 12 이상 탑재 기기
    2. 부트로더 언락이 가능한 기기
    3. 1번 조건에 해당하지 않는다면, 해당 기기에서 설치할 수 있는 커스텀 롬이 나와 있는지, 
    아니면 하다못해 GSI 롬으로 설치할 수 있는지? (Treble을 지원하는 기기인지?)
    4. 화면 크기가 최소 17인치 이상이어야 한다.
        1. 10~11인치 2대를 이어붙여 전시하기로 결정
- 태블릿을 그대로 사람들에게 보여줄 것이기 때문에, 별도의 디스플레이는 마련하지 않을 것이다.

# 어떤 기기를 구매해야 할까

요구 스펙을 다시 한 번 정리해 보자.

1. 안드로이드 12 이상 탑재 기기 또는 부트로더 언락 가능하며 커스텀 롬이 있는 기기
2. 17인치 이상의 디스플레이 탑재

아 맞다! 나는 보통 [GSMArena](https://www.gsmarena.com/results.php3?mode=tablet&fDisplayInchesMin=13)에서 스마트폰이나 태블릿을 스펙으로 검색하는데,
보통 사람들이 많이 쓰는 인치수는 10~13인치 사이라서 이보다 큰 태블릿은 여기에 잘 없다.

때문에, 아마존과 알리익스프레스에서 원하는 크기와 가격, 스펙을 비교하며 찾아봐야 하겠다.
여기서 사면 직배송도 되니까 한결 낫고.

## 1) Allview Viva Home (MT8163, 17인치, 안드9 선탑재)

[https://phoneopedia.com/products/allview-viva-home](https://phoneopedia.com/products/allview-viva-home)

![Untitled](%E1%84%8F%E1%85%A2%E1%86%B8%E1%84%89%E1%85%B3%E1%84%90%E1%85%A9%E1%86%AB%E1%84%83%E1%85%B5%E1%84%8C%E1%85%A1%E1%84%8B%E1%85%B5%E1%86%AB%20(3)%2077b7385a1018447ebab04f3e99a4de86/Untitled.png)

- 가격이 213달러로, 관부가세 10%에 배대지 붙여도 250달러 선에서 끊을 수 있다.
- 디스플레이 나쁘지 않고, 안드9 선탑재라 Treble을 지원한다.
- 부트로더 언락도 가능한 것 같다.
- 한계 : AP 제조사가 미디어텍이라 롬이 없을 것 같고, 가능하더라도 직접 포팅하거나 빌드해야 할 것 같다.
그리고 구매처가 없다.

## 2) 10~11인치 초저가 태블릿을 세트당 2대 붙여서 구성하기 (채택)

![ddd.jpeg](%E1%84%8F%E1%85%A2%E1%86%B8%E1%84%89%E1%85%B3%E1%84%90%E1%85%A9%E1%86%AB%E1%84%83%E1%85%B5%E1%84%8C%E1%85%A1%E1%84%8B%E1%85%B5%E1%86%AB%20(3)%2077b7385a1018447ebab04f3e99a4de86/ddd.jpeg)

- 16:9 또는 16:10 비율을 세로 방향으로 2대 이어붙이면 4:3, 5:4에 가까운 비율이 나올 것
- 14인치 이상의 안드로이드 탑재 태블릿은 구매처가 사실상 없고 있더라도 터무니없이 비쌈
    - 위쪽, 아래쪽 각각 앱 내부에서 두 가지 모드로 놓고, 모드 각각의 화면을 따로 구성하면 좋겠다.
- 멀리 갈 것도 없이 쿠팡에서 10인치, 11인치 태블릿으로 검색하면 대당 10만원 안쪽으로 끊을 수 있으니, 총 40만원에 안드로이드 기기와 디스플레이 문제를 해결할 수 있다.
    - 나머지 예산 30만원으로는 상전이 없다면 배터리, 그리고 세트 꾸미는 비용으로 충당하기
    
- 자료화면의 기준이 되는 화면은 레노버 P11 (5:3, 2000x1200)로, 세로로 이어붙였을 때 5:6, 2000x2400이 됨을 보여주기 위해 제시한다.

# 예산 다시 정리하기

<aside>
💡 링크사업단 캡스톤디자인 지원사업 신청하기
H/W+S/W부문 사업 선정시 70만원 지원

</aside>

1. 안드로이드 태블릿 4대 (10~12인치, 약 40~45만원)
2. 배터리 (USB 충전식, 약 15~20만원)
3. 세트 꾸미기 (나머지)

먼저 시연을 하고

설치 여부는 학교 반응 보고

# 해볼만한 것들

- [디바이스마트 공모전](https://www.devicemart.co.kr/board/view?id=award_board&seq=122661)
- [캡스톤디자인 지원사업](https://www.dankook.ac.kr/web/kor/-390?p_p_id=Bbs_WAR_bbsportlet&p_p_lifecycle=0&p_p_state=normal&p_p_mode=view&_Bbs_WAR_bbsportlet_action=view_message&_Bbs_WAR_bbsportlet_messageId=735155)

# 추가적인 아이디어

<aside>
💡 BLE (Bluetooth Low Energy)를 활용한 비콘 기능을 앱에 탑재하여, 블루투스가 연결된 주변 사람들의 단말기에 버스 도착이 임박했을 때 진동으로 알려주는 기능을 구현하면 어떨까? 저녁 먹으러 도서관에서 내려올 때 갑자기 생각남!

</aside>

스마트싱스 스테이션 관련 글 보다가 갑자기 생각났는데, IoT에 들어가는 저전력 무선통신 기술을 우리 아이템에도 적용해서 활용할 방법이 있지 않을까 생각했다.

---

<aside>
💡 학교 수업

</aside>

# OT

- 성적
    1. 발표
    2. 완성도
    3. 토론
    4. 보고서 (과제제안서, 최종보고서)
    5. 출석

- 발표는 4/5에 **************영어로** 발표
    - 서류발표 1주일 후네..

- 서류마감, 지원사업마감 (3/21) → 서류발표 (3/28?) → 과제제안발표 (4/5)

- 실현가능성, 팀의 역량, 경제적 가치 및 잠재적 상업성